String.prototype.format=function(){for(var c=this,e=arguments.length;e--;)c=c.replace(new RegExp("\\{"+e+"\\}","gm"),arguments[e]);return c};
!function(c){c.timeoutDialog=function(e){var a={timeout:1200,countdown:60,title:"Your session is about to expire!",message:"You will be logged out in {0} seconds.",question:"Do you want to stay signed in?",keep_alive_button_text:"Yes, Keep me signed in",sign_out_button_text:"No, Sign me out",keep_alive_url:"/keep-alive",logout_url:null,logout_redirect_url:"/",restart_on_yes:!0,dialog_width:450};c.extend(a,e);({init:function(){this.setupDialogTimer()},setupDialogTimer:function(){var b=this;window.setTimeout(function(){b.setupDialog()},
1E3*(a.timeout-a.countdown))},setupDialog:function(){var b=this;b.destroyDialog();c('<div id="timeout-dialog"><p id="timeout-message">'+a.message.format('<span id="timeout-countdown">'+a.countdown+"</span>")+'</p><p id="timeout-question">'+a.question+"</p></div>").appendTo("body").dialog({modal:!0,width:a.dialog_width,minHeight:"auto",zIndex:1E4,closeOnEscape:!1,draggable:!1,resizable:!1,dialogClass:"timeout-dialog",title:a.title,buttons:{"keep-alive-button":{text:a.keep_alive_button_text,class:"fr-btn fr-mr-2w",
id:"timeout-keep-signin-btn",click:function(){b.keepAlive()}},"sign-out-button":{text:a.sign_out_button_text,class:"fr-btn fr-btn--secondary",id:"timeout-sign-out-button",click:function(){b.signOut(!0)}}}});b.startCountdown()},setupFinSessionDialog:function(){var b=this;b.destroyDialog();c('<div id="timeout-dialog"><p id="timeout-message">'+a.fin_session_message+' </p><p id="timeout-question">'+a.fin_session_question+" </p></div>").appendTo("body").dialog({modal:!0,width:a.dialog_width,minHeight:"auto",
zIndex:1E4,closeOnEscape:!1,draggable:!1,resizable:!1,dialogClass:"timeout-dialog",title:a.fin_session_title,buttons:{"rester-button":{text:a.rester_page_button_text,class:"fr-btn",id:"timeout-keep-signin-btn",click:function(){b.destroyDialog();c.post(a.logout_url,function(d){b.redirectLogout(!0)})}}}})},destroyDialog:function(){c("#timeout-dialog").length&&c("#timeout-dialog").remove()},startCountdown:function(){var b=this,d=a.countdown;this.countdown=window.setInterval(function(){--d;c("#timeout-countdown").html(d);
0>=d&&(window.clearInterval(b.countdown),b.setupFinSessionDialog())},1E3)},keepAlive:function(){var b=this;this.destroyDialog();window.clearInterval(this.countdown);c.get(a.keep_alive_url,function(d,f){"success"==f?a.restart_on_yes&&b.setupDialogTimer():b.signOut(!1)})},signOut:function(b){var d=this;this.destroyDialog();null!=a.logout_url?c.post(a.logout_url,function(f){d.redirectLogout(b)}):d.redirectLogout(b)},redirectLogout:function(b){var d=a.logout_redirect_url;b||(d+="&timeout=t");window.location=
d}}).init()}}(window.jQuery);
